<nav class="bg-white shadow-md sticky top-0 z-50">
  <div class="max-w-10xl mx-auto px-6 py-3 flex justify-between items-center">

    <!-- Left: Logo + Brand -->
    <div class="hidden md:flex items-center md:ml-[40px]">
      <img src="/images/navlogo.png" alt="Logo" class="w-10 h-10 rounded-full mr-2">
      <span class="text-3xl font-bold text-red-600">Royal Panda</span>
    </div>

    <!-- Right: Menu + Cart + Sign Up (Desktop) -->
    <div class="hidden md:flex items-center space-x-8 md:mr-[40px]">
      <a href="/" class="text-red-600 font-semibold border-b-2 border-red-600 pb-1">Home</a>
      <a href="/order" class="text-gray-600 font-medium hover:text-red-600 transition">Menu</a>
      <a href="/about" class="text-gray-600 font-medium hover:text-red-600 transition">About</a>
      <a href="/contact" class="text-gray-600 font-medium hover:text-red-600 transition">Contact</a>

      <% if (user && user.role === 'admin') { %>
        <a href="/host/admin" class="text-gray-600 font-medium hover:text-red-600 transition">Admin</a>
      <% } %>

      <!-- Cart Icon -->
      <a href="/cart" class="relative">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-red-600 hover:text-red-700 transition" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.2 6h12.4M10 21a1 1 0 11-2 0 1 1 0zm8 0a1 1 0 11-2 0 1 1 0z" />
        </svg>
        <span class="cart-badge absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">
          <%= cartCount || 0 %>
        </span>
      </a>

      <!-- Sign Up / Logout -->
      <% if (!user) { %>
        <form action="/auth/signup" method="get">
          <button type="submit" class="bg-red-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-red-700 transition">
            Sign Up
          </button>
        </form>
      <% } else { %>
        <form action="/auth/logout" method="post">
          <button type="submit" class="bg-gray-300 text-black font-semibold px-4 py-2 rounded-lg hover:bg-gray-400 transition">
            Logout
          </button>
        </form>
      <% } %>
    </div>
  </div>

  <!-- Mobile View -->
  <div class="flex items-center justify-between px-6 md:hidden">
    <div class="flex items-center space-x-2">
      <img src="/images/navlogo.png" alt="Logo" class="w-10 h-10 rounded-full">
      <span class="text-2xl font-bold text-red-600">Royal Panda</span>
    </div>

    <div class="flex items-center space-x-4">
      <a href="/cart" class="relative">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-red-600 hover:text-red-700 transition" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.2 6h12.4M10 21a1 1 0 11-2 0 1 1 0zm8 0a1 1 0 11-2 0 1 1 0z" />
        </svg>
        <span id="cartCount" class="cart-badge absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">
          <%= cartCount || 0 %>
        </span>
      </a>

      <!-- Mobile Menu Button -->
      <button class="text-red-600 focus:outline-none" id="mobile-menu-btn">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Drawer -->
  <div class="fixed top-0 left-0 w-2/3 h-full bg-white shadow-xl transform -translate-x-full transition-transform duration-300 ease-in-out z-50 md:hidden" id="mobile-menu">
    <div class="p-6">
      <div class="flex items-center space-x-2 mb-6">
        <img src="/images/navlogo.png" alt="Logo" class="w-10 h-10 rounded-full">
        <span class="text-2xl font-bold text-red-600">Royal Panda</span>
      </div>

      <a href="/" class="block px-4 py-3 text-red-600 font-semibold border-l-4 border-red-600 bg-red-50">Home</a>
      <a href="/menu" class="block px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition">Menu</a>
      <a href="/about" class="block px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition">About</a>
      <a href="/contact" class="block px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition">Contact</a>

      <% if (user && user.role === 'admin') { %>
        <a href="/host/admin" class="block px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition">Admin</a>
      <% } %>

      <% if (!user) { %>
        <a href="/auth/login" class="block px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition mt-4 border-t border-gray-100">Login</a>
        <a href="/auth/signup" class="block mt-2 mx-4 py-2 text-white bg-red-600 rounded-lg text-center hover:bg-red-700 transition">Sign Up</a>
      <% } else { %>
        <form action="/auth/logout" method="post" class="mt-4 mx-4">
          <button type="submit" class="w-full py-2 bg-gray-300 rounded-lg text-black font-semibold hover:bg-gray-400 transition">Logout</button>
        </form>
      <% } %>
    </div>
  </div>

  <!-- Overlay -->
  <div class="fixed inset-0 bg-black opacity-0 hidden z-40 transition-opacity duration-300 ease-in-out" id="menu-overlay"></div>

  <script>
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuOverlay = document.getElementById('menu-overlay');

    function toggleMenu() {
      mobileMenu.classList.toggle('-translate-x-full');
      menuOverlay.classList.toggle('hidden');
      menuOverlay.classList.toggle('opacity-50');
      document.body.classList.toggle('overflow-hidden');
    }

    menuBtn.addEventListener('click', toggleMenu);
    menuOverlay.addEventListener('click', toggleMenu);

    function updateCartBadge() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      document.querySelectorAll(".cart-badge").forEach(span => {
        span.textContent = cart.length;
      });
    }
    updateCartBadge();
  </script>
</nav>
